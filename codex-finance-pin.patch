 (cd "$(git rev-parse --show-toplevel)" && git apply --3way <<'EOF' 
diff --git a/web/src/components/ConfirmPinModal.tsx b/web/src/components/ConfirmPinModal.tsx
new file mode 100644
index 0000000000000000000000000000000000000000..fe8b986f3882de07e1d21eb78adfa6ac86ced20a
--- /dev/null
+++ b/web/src/components/ConfirmPinModal.tsx
@@ -0,0 +1,156 @@
+import React, { useEffect, useMemo, useState } from 'react';
+import { FinanceMovement } from '../context/PosContext';
+import { getFinancePinHash, hashPin, setFinancePinHash, validateFinancePin } from '../utils/financePin';
+
+type ConfirmPinModalProps = {
+  movement: FinanceMovement;
+  onCancel: () => void;
+  onConfirm: () => Promise<void>;
+};
+
+export const ConfirmPinModal: React.FC<ConfirmPinModalProps> = ({ movement, onCancel, onConfirm }) => {
+  const [pin, setPin] = useState('');
+  const [confirmPin, setConfirmPin] = useState('');
+  const [error, setError] = useState('');
+  const [hasExistingPin, setHasExistingPin] = useState<boolean | null>(null);
+  const [isSubmitting, setIsSubmitting] = useState(false);
+
+  useEffect(() => {
+    setHasExistingPin(Boolean(getFinancePinHash()));
+  }, []);
+
+  const formattedDate = useMemo(() => {
+    const date = new Date(movement.date);
+    return `${date.toLocaleDateString()} ${date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}`;
+  }, [movement.date]);
+
+  const formattedAmount = useMemo(() => {
+    const sign = movement.kind === 'entrada' ? '+' : '-';
+    return `${sign}$${movement.amount.toFixed(2)}`;
+  }, [movement.amount, movement.kind]);
+
+  const handleConfirm = async () => {
+    if (hasExistingPin === null) return;
+    setError('');
+    setIsSubmitting(true);
+
+    try {
+      if (!hasExistingPin) {
+        if (pin.length < 4) {
+          setError('El PIN debe tener al menos 4 dígitos.');
+          return;
+        }
+
+        if (pin !== confirmPin) {
+          setError('Los PIN no coinciden.');
+          return;
+        }
+
+        const hash = await hashPin(pin);
+        setFinancePinHash(hash);
+        await onConfirm();
+        onCancel();
+        return;
+      }
+
+      if (!pin) {
+        setError('Ingresa tu PIN para continuar.');
+        return;
+      }
+
+      const isValid = await validateFinancePin(pin);
+      if (!isValid) {
+        setError('PIN incorrecto. Inténtalo nuevamente.');
+        return;
+      }
+
+      await onConfirm();
+      onCancel();
+    } finally {
+      setIsSubmitting(false);
+    }
+  };
+
+  return (
+    <div className="fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4">
+      <div className="bg-white rounded-xl shadow-xl w-full max-w-md p-6 space-y-4">
+        <div className="space-y-1">
+          <p className="text-sm font-semibold text-coffee">¿Eliminar movimiento?</p>
+          <p className="text-xs text-coffee/70">Esta acción no se puede deshacer.</p>
+        </div>
+
+        <div className="rounded-lg border border-cream p-4 bg-cream/40 space-y-1">
+          <p className="text-sm font-semibold text-coffee">{movement.concept}</p>
+          <p className="text-xs text-coffee/70">{formattedDate}</p>
+          <p
+            className={`text-sm font-semibold ${
+              movement.kind === 'entrada' ? 'text-accent' : 'text-coffee'
+            }`}
+          >
+            {formattedAmount}
+          </p>
+        </div>
+
+        {hasExistingPin === false ? (
+          <div className="space-y-3">
+            <p className="text-sm font-semibold text-coffee">Configurar PIN de Finanzas</p>
+            <p className="text-xs text-coffee/70">
+              Crea un PIN de al menos 4 dígitos. Lo usarás para autorizar eliminaciones en Finanzas.
+            </p>
+            <input
+              type="password"
+              value={pin}
+              onChange={(e) => setPin(e.target.value)}
+              className="w-full border border-cream rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-mint"
+              placeholder="Nuevo PIN"
+              minLength={4}
+            />
+            <input
+              type="password"
+              value={confirmPin}
+              onChange={(e) => setConfirmPin(e.target.value)}
+              className="w-full border border-cream rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-mint"
+              placeholder="Repetir PIN"
+              minLength={4}
+            />
+          </div>
+        ) : (
+          <div className="space-y-2">
+            <label className="text-sm font-medium text-coffee" htmlFor="finance-pin-input">
+              Ingresa tu PIN de Finanzas
+            </label>
+            <input
+              id="finance-pin-input"
+              type="password"
+              value={pin}
+              onChange={(e) => setPin(e.target.value)}
+              className="w-full border border-cream rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-mint"
+              placeholder="PIN"
+            />
+          </div>
+        )}
+
+        {error && <p className="text-sm text-red-600">{error}</p>}
+
+        <div className="flex items-center justify-end gap-3">
+          <button
+            type="button"
+            onClick={onCancel}
+            className="px-4 py-2 text-sm font-semibold text-coffee hover:text-coffee/70"
+            disabled={isSubmitting}
+          >
+            Cancelar
+          </button>
+          <button
+            type="button"
+            onClick={handleConfirm}
+            disabled={isSubmitting}
+            className="btn-primary disabled:opacity-70 disabled:cursor-not-allowed"
+          >
+            {hasExistingPin === false ? 'Guardar y eliminar' : 'Confirmar'}
+          </button>
+        </div>
+      </div>
+    </div>
+  );
+};
diff --git a/web/src/context/PosContext.tsx b/web/src/context/PosContext.tsx
index 762bbd4f6d3ebe1dc012dc779f4fba0ea7a50e2b..d0d269dd14fb5830276d71ceecfdf3441d2da91a 100644
--- a/web/src/context/PosContext.tsx
+++ b/web/src/context/PosContext.tsx
@@ -7,51 +7,51 @@ export type Product = {
   price: number;
   stock: number;
 };
 
 export type SaleItem = {
   productId: string;
   name: string;
   price: number;
   quantity: number;
 };
 
 export type Sale = {
   id: string;
   items: SaleItem[];
   total: number;
   date: string;
 };
 
 export type FinanceMovement = {
   id: string;
   box: 'chica' | 'grande';
   kind: 'entrada' | 'salida';
   amount: number;
   concept: string;
   date: string;
-  source?: 'manual' | 'venta';
+  source?: 'manual' | 'sale' | 'venta';
 };
 
 export type Client = {
   id: string;
   name: string;
   phone: string;
   address: string;
   active: boolean;
   notes: string;
 };
 
 export type CreditPayment = {
   id: string;
   amount: number;
   date: string;
   note?: string;
 };
 
 export type Credit = {
   id: string;
   clientId: string;
   amount: number;
   date: string;
   status: 'pendiente' | 'pagado';
   payments: CreditPayment[];
@@ -76,86 +76,93 @@ export type RawMaterial = {
 export type RawMaterialMovement = {
   id: string;
   materialId: string;
   type: 'entrada' | 'salida';
   amount: number;
   note: string;
   date: string;
 };
 
 type SalePayload = { productId: string; quantity: number }[];
 
 type PosContextValue = {
   products: Product[];
   sales: Sale[];
   financeMovements: FinanceMovement[];
   clients: Client[];
   credits: Credit[];
   fridgeLoans: FridgeLoan[];
   rawMaterials: RawMaterial[];
   rawMaterialMovements: RawMaterialMovement[];
   addProduct: (product: Omit<Product, 'id'>) => void;
   updateProduct: (id: string, changes: Partial<Omit<Product, 'id'>>) => void;
   deleteProduct: (id: string) => void;
   recordSale: (items: SalePayload) => { success: boolean; message?: string };
   addFinanceMovement: (movement: Omit<FinanceMovement, 'id'>) => void;
+  deleteCashMovement: (box: FinanceMovement['box'], movementId: string) => void;
   addClient: (client: Omit<Client, 'id'>) => void;
   updateClient: (id: string, changes: Partial<Omit<Client, 'id'>>) => void;
   deleteClient: (id: string) => void;
   addCredit: (credit: Omit<Credit, 'id' | 'payments' | 'status'>) => void;
   addCreditPayment: (creditId: string, payment: Omit<CreditPayment, 'id'>) => void;
   updateCreditStatus: (creditId: string, status: Credit['status']) => void;
   addFridgeLoan: (loan: Omit<FridgeLoan, 'id' | 'status' | 'returnDate'>) => void;
   markFridgeReturned: (loanId: string) => void;
   addRawMaterial: (material: Omit<RawMaterial, 'id'>) => void;
   updateRawMaterial: (id: string, changes: Partial<Omit<RawMaterial, 'id'>>) => void;
   deleteRawMaterial: (id: string) => void;
   recordMaterialMovement: (movement: Omit<RawMaterialMovement, 'id'>) => { success: boolean; message?: string };
 };
 
 const PosContext = createContext<PosContextValue | null>(null);
 const PRODUCTS_KEY = 'hedelmia_products';
 const SALES_KEY = 'hedelmia_sales';
 const FINANCE_KEY = 'hedelmia_finance';
 const CLIENTS_KEY = 'hedelmia_clients';
 const CREDITS_KEY = 'hedelmia_credits';
 const FRIDGES_KEY = 'hedelmia_fridge_loans';
 const RAW_MATERIALS_KEY = 'hedelmia_raw_materials';
 const RAW_MATERIAL_MOVEMENTS_KEY = 'hedelmia_raw_material_movements';
 
 function generateId() {
   return typeof crypto !== 'undefined' && 'randomUUID' in crypto
     ? crypto.randomUUID()
     : Math.random().toString(36).slice(2, 10);
 }
 
 export const PosProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {
   const [products, setProducts] = useState<Product[]>(() => loadFromStorage(PRODUCTS_KEY, []));
   const [sales, setSales] = useState<Sale[]>(() => loadFromStorage(SALES_KEY, []));
-  const [financeMovements, setFinanceMovements] = useState<FinanceMovement[]>(
-    () => loadFromStorage(FINANCE_KEY, []),
-  );
+  const [financeMovements, setFinanceMovements] = useState<FinanceMovement[]>(() => {
+    const stored = loadFromStorage<FinanceMovement[]>(FINANCE_KEY, []);
+    if (!Array.isArray(stored)) return [];
+
+    return stored.map((movement) => ({
+      ...movement,
+      source: movement.source === 'venta' ? 'sale' : movement.source ?? 'manual',
+    }));
+  });
   const [clients, setClients] = useState<Client[]>(() => {
     const storedClients = loadFromStorage<Client[]>(CLIENTS_KEY, []);
     if (!Array.isArray(storedClients)) return [];
 
     return storedClients.map((client) => ({
       ...client,
       phone: client.phone ?? '',
       address: client.address ?? '',
     }));
   });
   const [credits, setCredits] = useState<Credit[]>(() => loadFromStorage(CREDITS_KEY, []));
   const [fridgeLoans, setFridgeLoans] = useState<FridgeLoan[]>(() => loadFromStorage(FRIDGES_KEY, []));
   const [rawMaterials, setRawMaterials] = useState<RawMaterial[]>(
     () => loadFromStorage(RAW_MATERIALS_KEY, []),
   );
   const [rawMaterialMovements, setRawMaterialMovements] = useState<RawMaterialMovement[]>(
     () => loadFromStorage(RAW_MATERIAL_MOVEMENTS_KEY, []),
   );
 
   useEffect(() => {
     const syncFromStorage = () => {
       setProducts(loadFromStorage(PRODUCTS_KEY, []));
       setSales(loadFromStorage(SALES_KEY, []));
     };
 
@@ -235,58 +242,67 @@ export const PosProvider: React.FC<{ children: React.ReactNode }> = ({ children
       }
 
       updatedProducts[productIndex] = { ...product, stock: product.stock - quantity };
       saleItems.push({ productId, name: product.name, price: product.price, quantity });
       total += product.price * quantity;
     }
 
     const sale: Sale = {
       id: generateId(),
       items: saleItems,
       total,
       date: new Date().toISOString(),
     };
 
     setProducts(updatedProducts);
     setSales((prev) => [...prev, sale]);
     setFinanceMovements((prev) => [
       ...prev,
       {
         id: generateId(),
         box: 'grande',
         kind: 'entrada',
         amount: total,
         concept: 'Venta POS',
         date: sale.date,
-        source: 'venta',
+        source: 'sale',
       },
     ]);
     return { success: true };
   };
 
   const addFinanceMovement = (movement: Omit<FinanceMovement, 'id'>) => {
-    setFinanceMovements((prev) => [...prev, { ...movement, id: generateId() }]);
+    setFinanceMovements((prev) => [
+      ...prev,
+      { ...movement, id: generateId(), source: movement.source ?? 'manual' },
+    ]);
+  };
+
+  const deleteCashMovement = (box: FinanceMovement['box'], movementId: string) => {
+    setFinanceMovements((prev) =>
+      prev.filter((movement) => movement.box !== box || movement.id !== movementId),
+    );
   };
 
   const addClient = (client: Omit<Client, 'id'>) => {
     setClients((prev) => [...prev, { ...client, id: generateId() }]);
   };
 
   const updateClient = (id: string, changes: Partial<Omit<Client, 'id'>>) => {
     setClients((prev) => prev.map((client) => (client.id === id ? { ...client, ...changes } : client)));
   };
 
   const deleteClient = (id: string) => {
     setClients((prev) => prev.filter((client) => client.id !== id));
   };
 
   const addCredit = (credit: Omit<Credit, 'id' | 'payments' | 'status'>) => {
     const payload: Credit = { ...credit, id: generateId(), status: 'pendiente', payments: [] };
     setCredits((prev) => [...prev, payload]);
   };
 
   const updateCreditStatus = (creditId: string, status: Credit['status']) => {
     setCredits((prev) => prev.map((credit) => (credit.id === creditId ? { ...credit, status } : credit)));
   };
 
   const addCreditPayment = (creditId: string, payment: Omit<CreditPayment, 'id'>) => {
     setCredits((prev) =>
@@ -334,58 +350,60 @@ export const PosProvider: React.FC<{ children: React.ReactNode }> = ({ children
     const delta = movement.type === 'entrada' ? movement.amount : -movement.amount;
     const newStock = material.stock + delta;
 
     if (newStock < 0) return { success: false, message: 'No puedes tener stock negativo' };
 
     updateRawMaterial(material.id, { stock: newStock });
     setRawMaterialMovements((prev) => [...prev, { ...movement, id: generateId() }]);
     return { success: true };
   };
 
   const value = useMemo(
     () => ({
       products,
       sales,
       financeMovements,
       clients,
       credits,
       fridgeLoans,
       rawMaterials,
       rawMaterialMovements,
       addProduct,
       updateProduct,
       deleteProduct,
       recordSale,
       addFinanceMovement,
+      deleteCashMovement,
       addClient,
       updateClient,
       deleteClient,
       addCredit,
       addCreditPayment,
       updateCreditStatus,
       addFridgeLoan,
       markFridgeReturned,
       addRawMaterial,
       updateRawMaterial,
       deleteRawMaterial,
       recordMaterialMovement,
     }),
     [
       products,
       sales,
       financeMovements,
       clients,
       credits,
       fridgeLoans,
       rawMaterials,
       rawMaterialMovements,
+      deleteCashMovement,
     ],
   );
 
   return <PosContext.Provider value={value}>{children}</PosContext.Provider>;
 };
 
 export function usePos() {
   const context = useContext(PosContext);
   if (!context) throw new Error('usePos debe usarse dentro de PosProvider');
   return context;
 }
diff --git a/web/src/pages/FinancePage.tsx b/web/src/pages/FinancePage.tsx
index f06c8f24072eff5df4f5e894aadf0c2650b0acbb..2a323571340059c604a9371c8e10d9ae9742fd43 100644
--- a/web/src/pages/FinancePage.tsx
+++ b/web/src/pages/FinancePage.tsx
@@ -1,80 +1,89 @@
 import React, { useMemo, useState } from 'react';
-import { usePos } from '../context/PosContext';
+import { ConfirmPinModal } from '../components/ConfirmPinModal';
+import { FinanceMovement, usePos } from '../context/PosContext';
 
 const today = new Date().toISOString().slice(0, 10);
 
 type MovementForm = { concept: string; amount: number; kind: 'entrada' | 'salida'; date: string };
 
 const emptyForm: MovementForm = { concept: '', amount: 0, kind: 'entrada', date: today };
 
 export const FinancePage: React.FC = () => {
-  const { financeMovements, addFinanceMovement } = usePos();
+  const { financeMovements, addFinanceMovement, deleteCashMovement } = usePos();
   const [forms, setForms] = useState<Record<'chica' | 'grande', MovementForm>>({
     chica: emptyForm,
     grande: emptyForm,
   });
+  const [movementToDelete, setMovementToDelete] = useState<FinanceMovement | null>(null);
 
   const balances = useMemo(() => {
     return ['chica', 'grande'].reduce(
       (acc, box) => ({
         ...acc,
         [box]: financeMovements
           .filter((movement) => movement.box === box)
           .reduce((total, movement) =>
             movement.kind === 'entrada' ? total + movement.amount : total - movement.amount,
           0),
       }),
       { chica: 0, grande: 0 } as Record<'chica' | 'grande', number>,
     );
   }, [financeMovements]);
 
   const registerMovement = (box: 'chica' | 'grande') => (event: React.FormEvent) => {
     event.preventDefault();
     const form = forms[box];
     if (!form.concept.trim() || form.amount <= 0) return;
 
     addFinanceMovement({ ...form, box, source: 'manual', amount: Number(form.amount) });
     setForms((prev) => ({ ...prev, [box]: { ...emptyForm, date: form.date } }));
   };
 
   const formatDate = (iso: string) => {
     const date = new Date(iso);
     return `${date.toLocaleDateString()} ${date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}`;
   };
 
   const recentMovements = (box: 'chica' | 'grande') =>
     [...financeMovements]
       .filter((movement) => movement.box === box)
       .sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime())
       .slice(0, 6);
 
+  const confirmDeletion = async () => {
+    if (!movementToDelete) return;
+    deleteCashMovement(movementToDelete.box, movementToDelete.id);
+    setMovementToDelete(null);
+  };
+
   return (
-    <div className="grid grid-cols-1 xl:grid-cols-2 gap-4">
-      {[{ key: 'chica', title: 'Caja chica' }, { key: 'grande', title: 'Caja grande' }].map(
-        ({ key, title }) => {
-          const boxKey = key as 'chica' | 'grande';
+    <>
+      <div className="grid grid-cols-1 xl:grid-cols-2 gap-4">
+        {[{ key: 'chica', title: 'Caja chica' }, { key: 'grande', title: 'Caja grande' }].map(
+          ({ key, title }) => {
+            const boxKey = key as 'chica' | 'grande';
           const form = forms[boxKey];
           return (
             <div key={key} className="card p-6 space-y-4">
               <div className="flex items-center justify-between">
                 <div>
                   <p className="text-sm text-coffee/70">{title}</p>
                   <p className="text-3xl font-bold">${balances[boxKey].toFixed(2)}</p>
                   <p className="text-xs text-coffee/60">
                     {boxKey === 'chica'
                       ? 'Entradas y salidas manuales'
                       : 'Ventas automáticas + movimientos manuales'}
                   </p>
                 </div>
                 <span className="text-xs px-3 py-1 rounded-full bg-cream text-coffee/80">
                   {recentMovements(boxKey).length} movimientos recientes
                 </span>
               </div>
 
               <form onSubmit={registerMovement(boxKey)} className="grid grid-cols-1 md:grid-cols-2 gap-4 items-end">
                 <label className="flex flex-col gap-1 text-sm font-medium">
                   Concepto
                   <input
                     className="border border-cream rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-mint"
                     value={form.concept}
                     onChange={(e) =>
@@ -109,55 +118,89 @@ export const FinancePage: React.FC = () => {
                 </label>
                 <label className="flex flex-col gap-2 text-sm font-medium">
                   Tipo
                   <div className="flex items-center gap-3">
                     {['entrada', 'salida'].map((type) => (
                       <label key={type} className="flex items-center gap-2 text-sm font-medium">
                         <input
                           type="radio"
                           name={`${boxKey}-type`}
                           value={type}
                           checked={form.kind === type}
                           onChange={() =>
                             setForms((prev) => ({ ...prev, [boxKey]: { ...form, kind: type as MovementForm['kind'] } }))
                           }
                         />
                         {type === 'entrada' ? 'Entrada' : 'Salida'}
                       </label>
                     ))}
                   </div>
                 </label>
                 <button type="submit" className="btn-primary md:col-span-2">Registrar movimiento</button>
               </form>
 
               <div className="space-y-2">
                 <h3 className="text-sm font-semibold text-coffee">Últimos movimientos</h3>
-                {recentMovements(boxKey).map((movement) => (
-                  <div
-                    key={movement.id}
-                    className="border border-cream rounded-lg px-4 py-3 flex items-center justify-between"
-                  >
-                    <div>
-                      <p className="font-semibold">{movement.concept}</p>
-                      <p className="text-xs text-coffee/70">{formatDate(movement.date)}</p>
-                      <p className="text-xs text-coffee/60 capitalize">{movement.source === 'venta' ? 'Venta automática' : 'Manual'} - {movement.kind}</p>
-                    </div>
-                    <span
-                      className={`font-semibold ${
-                        movement.kind === 'entrada' ? 'text-accent' : 'text-coffee'
-                      }`}
+                {recentMovements(boxKey).map((movement) => {
+                  const isSaleMovement = movement.source === 'sale' || movement.source === 'venta';
+
+                  return (
+                    <div
+                      key={movement.id}
+                      className="border border-cream rounded-lg px-4 py-3 flex items-center justify-between gap-4"
                     >
-                      {movement.kind === 'entrada' ? '+' : '-'}${movement.amount.toFixed(2)}
-                    </span>
-                  </div>
-                ))}
+                      <div className="space-y-1">
+                        <p className="font-semibold">{movement.concept}</p>
+                        <p className="text-xs text-coffee/70">{formatDate(movement.date)}</p>
+                        <p className="text-xs text-coffee/60 capitalize">
+                          {isSaleMovement ? 'Venta automática' : 'Manual'} - {movement.kind}
+                        </p>
+                        {isSaleMovement && (
+                          <p className="text-xs text-red-700">
+                            Este movimiento proviene de una venta. Para corregirlo, ajusta o elimina la venta.
+                          </p>
+                        )}
+                      </div>
+                      <div className="flex items-center gap-3">
+                        <span
+                          className={`font-semibold ${
+                            movement.kind === 'entrada' ? 'text-accent' : 'text-coffee'
+                          }`}
+                        >
+                          {movement.kind === 'entrada' ? '+' : '-'}${movement.amount.toFixed(2)}
+                        </span>
+                        <button
+                          type="button"
+                          className="text-sm font-semibold text-red-700 hover:text-red-800 disabled:text-coffee/50 disabled:cursor-not-allowed"
+                          disabled={isSaleMovement}
+                          onClick={() => setMovementToDelete(movement)}
+                          title={
+                            isSaleMovement
+                              ? 'No puedes eliminar movimientos generados por ventas.'
+                              : 'Eliminar movimiento'
+                          }
+                        >
+                          Eliminar
+                        </button>
+                      </div>
+                    </div>
+                  );
+                })}
                 {!recentMovements(boxKey).length && (
                   <p className="text-sm text-coffee/70">Aún no hay movimientos en esta caja.</p>
                 )}
               </div>
             </div>
           );
         },
       )}
-    </div>
+      </div>
+      {movementToDelete && (
+        <ConfirmPinModal
+          movement={movementToDelete}
+          onCancel={() => setMovementToDelete(null)}
+          onConfirm={confirmDeletion}
+        />
+      )}
+    </>
   );
 };
diff --git a/web/src/utils/financePin.ts b/web/src/utils/financePin.ts
new file mode 100644
index 0000000000000000000000000000000000000000..70b06363f75be4c6349c64a98b77ec2d8154a71e
--- /dev/null
+++ b/web/src/utils/financePin.ts
@@ -0,0 +1,23 @@
+const FINANCE_PIN_HASH_KEY = 'hedelmia_finance_pin_hash';
+
+export const getFinancePinHash = () => localStorage.getItem(FINANCE_PIN_HASH_KEY);
+
+export const setFinancePinHash = (hash: string) => {
+  localStorage.setItem(FINANCE_PIN_HASH_KEY, hash);
+};
+
+export async function hashPin(pin: string): Promise<string> {
+  const encoder = new TextEncoder();
+  const data = encoder.encode(pin);
+  const hashBuffer = await crypto.subtle.digest('SHA-256', data);
+  const hashArray = Array.from(new Uint8Array(hashBuffer));
+  return hashArray.map((byte) => byte.toString(16).padStart(2, '0')).join('');
+}
+
+export async function validateFinancePin(pin: string) {
+  const storedHash = getFinancePinHash();
+  if (!storedHash) return false;
+
+  const hash = await hashPin(pin);
+  return hash === storedHash;
+}
 
EOF
)
